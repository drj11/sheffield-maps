<xhtml>
<head>
<!-- per http://leafletjs.com/examples/quick-start/ -->
<link rel="stylesheet" href="https://unpkg.com/leaflet@1.2.0/dist/leaflet.css"
   integrity="sha512-M2wvCLH6DSRazYeZRIm1JnYyh22purTM+FDB5CsyxtQJYeKq83arPe5wgbNmcFXGqiSH2XR8dT/fJISVA1r/zQ=="
   crossorigin=""/>
<script src="https://unpkg.com/leaflet@1.2.0/dist/leaflet.js"
   integrity="sha512-lInM/apFSqyy1o6s89K4iQUKg6ppXEgsVxT35HbzUupEVRh2Eu9Wdl4tHj7dZO0s1uvplcYGmt3498TtHq+log=="
   crossorigin=""></script>
</head>
<body>
<div style="height:600px" id="mapid"></div>
<script>
var map = L.map('mapid').setView([53.4, -1.5], 11);

L.tileLayer(
'http://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
    attribution: '&copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a>',
        subdomains: ['a','b','c']
        }).addTo( map );

load = function(url, cb) {
  var xhr = new XMLHttpRequest();
  xhr.onreadystatechange = function() {
    if(xhr.readyState < 4) { return }
    cb(xhr)
  }
  xhr.open('GET', url)
  xhr.send()
}

bind_popup = function(url) {
  var id = /\d+(?=\.geojson)/.exec(url)[0]
  return function(feature, layer) {
    layer.bindPopup(id)
  }
}

add_geojson = function(url) {
  load(url, function(xhr) {
    var g = JSON.parse(xhr.responseText)
    var area = L.geoJSON(g, {
      onEachFeature: bind_popup(url)
    })
    map.addLayer(area)
    // map.fitBounds(area.getBounds());
  })
}

load("children.json", function(xhr) {
  children = JSON.parse(xhr.responseText)
  for(var id in children) {
    if(children[id].type == "MTW") {
      add_geojson("ward/" + id + ".geojson")
    }
  }
})


</script>
</body>
</html>
